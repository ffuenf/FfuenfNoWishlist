language: php
php:
- 7.0
- 7.1
- 7.2
- 7.3
matrix:
  fast_finish: true
  allow_failures:
  - php: 7.2
  - php: 7.3
sudo: false
services:
- mysql
env:
  matrix:
  - SHOPWARE_VERSION="5.5"
  global:
  - PLUGIN_NAME=FfuenfNoWishlist
  - SHOPWARE_DIRECTORY="${HOME}/shopware"
  - PLUGIN_DIRECTORY="${SHOPWARE_DIRECTORY}/custom/plugins"
cache:
  apt: true
  directories:
  - "${HOME}/.composer/cache"
install:
- mkdir -p build/logs
- travis_retry composer update --no-interaction
before_script:
- git clone https://github.com/shopware/shopware.git ${SHOPWARE_DIRECTORY} --branch
  ${SHOPWARE_VERSION}
- ant -f ${SHOPWARE_DIRECTORY}/build/build.xml -Dapp.host=localhost -Ddb.user=travis
  -Ddb.host=127.0.0.1 -Ddb.name=shopware build-unit
- mv ${TRAVIS_BUILD_DIR} ${PLUGIN_DIRECTORY}/${PLUGIN_NAME}
- php ${HOME}/shopware/bin/console sw:plugin:refresh
- php ${HOME}/shopware/bin/console sw:plugin:install ${PLUGIN_NAME}
- php ${HOME}/shopware/bin/console sw:plugin:activate ${PLUGIN_NAME}
- cd ${PLUGIN_DIRECTORY}/${PLUGIN_NAME}
script:
- composer test-unit
- composer test-spec
after_success:
- "./build.sh $TRAVIS_TAG"
deploy:
  skip_cleanup: true
  provider: releases
  file_glob: true
  file: "${PLUGIN_NAME}*.zip"
  on:
    tags: true
  api_key:
    secure: IcOUY9aKc+DCr7UENA0zHXKVYxP1yjoEpss1X+30fGBaeiltJQSDzjwOxHr6s2JE6Bg5MWM/DQ6ANAshmJPJrbHr8wnWztre/iG1Sa4jJwbNR39At8MprEaeblG6eRcr0d+OsiSPd6LLw82kfhTun5g/HoT57yhmFoDQROj/GWX6Qi9Zcr4iRq0hJcNn/dJoY0jMd1aPRW5K1VsTxJGlOAwrrJBHUuifO2D1CJHBf9JSy+Z2iXeGHcxb2mPiGnsqLRqSe2dWxL58sLN6bflgDLu2JqTWyRShqqyu0UQ/oftYQIHNkEqenoiLSAfSpaBZt9zYQRmbuCEZPYJ75wxJ6AXD2h8cOgR1IKCuOMHn/ncNVpc2RWoN4wPu9KqD3vjng6zpJu2IfE/je8ArbzFSCFCVMz2QwTxLHFv74SQ9hz4vrCTDXDv+9oA180pEczAzAbcB8CQPWf1lgOuDhJGnFeavDjPlBvDY6urCqGN5wN2hqY2qzEojR0lFtZU9GwlorqpmHfAEfr3m4cYZv9bb6Qi6aqgVbp6ndAnMUhBrlz2F6avdZg4ZWWQ4dTdO0nRD6LUdSoBdJDWoeT6PkfuQecRZ1rGxoMSikEVA+Dq5x1ltBjd+qErrMvtH0jUovG7sCCJlOxZrzZPZLiKdUk0Rregb1lnaaRriqhXoV3pdBIM=
notifications:
  slack:
    secure: OQE5qxYLkylCjrp5Fw7Ic9pt35CGeIihTZfOCJI0rOSqVEX7wD01jsWrWjsR6oBLF52sH3sHDa3gvx2LCC1TZtQ5C8zSkZUCK0Lys3RQnqrhngnxCez7fTXIOOxkCHoTGsLkAGm776kHeNpP4vyhWA0bq6H/8qZm+TxyNqkrfiQbMFec0hAYZEB23j4NAZofWzHrvzsp5tJHiwc9hZZk5326M2SXowO0pfiB8h+aLiCqdUZyKN8patR3CVvKvnqKRqoOAskRugFMNbRIujnIRycc9J34RGOlcEs/dSHMfCO/OKk5TnQI7FRZzasziW48VRrmc+PYj7P+w9J2c4lBqlXlY4XsGYlOShsm32S3uomVtXk2GoQCtr/2QoFRstjdM1nx0187jNf0pc13DxzSvBB70JW4IRuGZSFCneCwBYKH3M3maGbRI3988fr7IwmefG06ulw1byt9UALLpxqxDBPmtd6yL8LIsUTJ4Tgc6f3BmH+adBR5B72nZejlVaEluxM5kqjYO/3pUFpcVF4p3fwsF5gRX9E424LTvQpWLN580xNqEMVZFexNFJ99eZXK/J2nq4fBRt6tv9Va0sUTpvd0FI5ErPDHEafbP+pSV5erCOM9nEV+Ige9keyEjP/Rqr+Q2kXrccuDaBViaSRyocAzak6YgMpHquu1mqUYQjw=
